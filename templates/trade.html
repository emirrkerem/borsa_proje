{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Hisse Ekle</h2>
    <form id="tradeForm" class="row align-items-center g-2">
        <div class="col-md-2">
            <input type="text" class="form-control" placeholder="Hisse Sembolü" name="symbol" id="symbol">
        </div>
        <div class="col-md-2">
            <select class="form-control" name="action" id="action">
                <option value="buy">Alış</option>
                <option value="sell">Satış</option>
            </select>
        </div>
        <div class="col-md-2">
            <input type="number" class="form-control" placeholder="Miktar" name="quantity" id="quantity">
        </div>
        <div class="col-md-2">
            <input type="number" step="0.01" class="form-control" placeholder="Fiyat" name="price" id="price">
        </div>
        <div class="col-md-2 d-flex justify-content-center">
            <button type="button" class="btn btn-primary" onclick="addTrade()">Ekle</button>
        </div>
    </form>
</div>
    <!-- Trade Tablosu -->
<div class="container mt-4">
    <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th>Trades</th>
                <th>Action</th>
                <th>Miktar</th>
                <th>Tarih</th>
                <th>Fiyat</th>
                <th>Toplam Maliyet</th>
                <th>Çıkış Fiyatı</th>               
                <th>Kâr/Zarar</th>                
            </tr>
        </thead>
        <tbody id="tradeTableBody">
            <!-- Eklenen işlemler buraya dinamik olarak eklenecek -->
        </tbody>
    </table>
</div>

<script>
    function addTrade() {
        let symbol = document.getElementById("symbol").value;
        let quantity = document.getElementById("quantity").value;
        let buyPrice = document.getElementById("buy_price").value;
        let sellPrice = document.getElementById("sell_price").value;
        let date = new Date().toISOString().split('T')[0]; // Bugünün tarihi

        // Kâr/Zarar hesapla
        let profitLoss = ((sellPrice - buyPrice) / buyPrice * 100).toFixed(2);
        let profitClass = profitLoss >= 0 ? 'profit' : 'loss';

        // Yeni satırı ekle
        let table = document.getElementById("tradeTableBody");
        let row = `<tr>
                    <td>${date}</td>
                    <td>${symbol}</td>
                    <td>${quantity}</td>
                    <td>${buyPrice}</td>
                    <td>${sellPrice}</td>
                    <td class="${profitClass}">${profitLoss}%</td>
                    <td><button onclick="deleteRow(this)">Sil</button></td>
                  </tr>`;
        table.innerHTML += row;

        // Formu temizle
        document.getElementById("tradeForm").reset();
    }

    function deleteRow(button) {
        button.parentElement.parentElement.remove();
    }
</script>

{% endblock %}


